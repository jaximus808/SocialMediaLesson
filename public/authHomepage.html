<html>
    <head>
        <title>Croods homepage</title>
        <style>
            #profileContainer
            {
                position: absolute; 
                top:0;
                right:0; 
                background-color: #9d7ee6; 
                width: 20%;
                height:10%; 
                padding-left: 10px;
            }
            #profileUsername
            {

                font-family: Georgia, 'Times New Roman', Times, serif;
            }
            #profileImage
            {
                width:50px;
                height: 50px;
                position: absolute; 
                top:0;
                right:10px;
            }
        </style>
    </head>
    <body>
        <h1>The Croods Homepage</h1>
        <div id="profileContainer">
            <p id="profileUsername"></p>
            <img id="profileImage">
            <button onclick="logout()">Log out</button>
        </div>
        <script>
            const logout = () =>
            {
                fetch("http://localhost:3000/api/user/logout", {
                headers:{
                    "Content-Type":"application/json"
                },
                method:"POST",
                }).then(data =>
                {
                    window.location.href = "/"; 
                }) 
            }

            const init = () =>
            {
                //Gets the user details
                fetch("http://localhost:3000/api/user/getUserDetails", {
                headers:{
                    "Content-Type":"application/json"
                },
                method:"GET",
                }).then(res => res.json()).then(data =>
                {
                    //if there is an error in the data return out of the function and goes back home
                    if(data.error)
                    {
                        window.location.href = "/"; 
                        return; 
                    } 
                    ////replaces the profile username and profile image with the accounts information
                    document.getElementById("profileUsername").innerHTML = data.username;
                    document.getElementById("profileImage").setAttribute("src",data.imageLink)
                })
            }
            
            init();
        </script>
    </body>
</html> 